<?xml version="1.0" encoding="utf-8"?>
<root xmlns:android="http://schemas.android.com/apk/res/android" xmlns:tools="http://schemas.android.com/tools">
  
  <proguardAdditions>
	<insert>
	  ########################################################################################## Amazon
	  -dontwarn com.google.firebase.**
	  -keep class com.google.firebase.** {*;}
	</insert>
  </proguardAdditions>

  <androidManifestUpdates>
    <addElements tag="application">
      <provider
        android:name="com.google.firebase.provider.FirebaseInitProvider"
        android:authorities="${applicationId}.firebaseinitprovider"
        tools:node="remove"
      />
    </addElements>
  </androidManifestUpdates>
  
	<AARImports>
		<insertValue value="com.google.firebase,firebase-analytics,11.8.0" />
    <insertNewline/>
    
    <insertValue value="com.google.firebase,firebase-core,11.8.0" />
    <insertNewline/>
	</AARImports>

  <androidManifestUpdates>
    <addPermission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <addPermission android:name="android.permission.INTERNET" />
  </androidManifestUpdates>

  <buildscriptGradleAdditions>
    <insert>
      dependencies
      {
      classpath 'com.google.gms:google-services:4.0.0'
      }
    </insert>
  </buildscriptGradleAdditions>

  <buildGradleAdditions>
    <insertValue value="apply plugin: 'com.google.gms.google-services'"/>
    <insertNewline/>
  </buildGradleAdditions>

  <prebuildCopies>
    <copyFile src="$S(PluginDir)/../../../../Build/Android/google-services.json" dst="$S(BuildDir)/gradle/app/google-services.json"/>
  </prebuildCopies>

  <gameActivityImportAdditions>
    <insert>
      import com.google.firebase.FirebaseApp;
      import com.google.firebase.FirebaseOptions;
      import com.google.firebase.analytics.FirebaseAnalytics;
    </insert>
  </gameActivityImportAdditions>

  <gameActivityClassAdditions>
    <insert>
      private FirebaseAnalytics Analytics;

      public void AndroidThunkJava_Initialize(String ApplicationID, String APIKey,
                                              String DatabaseURL, String SenderID,
                                              String StorageBucket, String ProjectID)
      {
        FirebaseOptions.Builder OptionsBuilder = new FirebaseOptions.Builder()
                                                 .setApplicationId(ApplicationID)
                                                 .setApiKey(APIKey)
                                                 .setDatabaseUrl(DatabaseURL)
                                                 .setGcmSenderId(SenderID)
                                                 .setStorageBucket(StorageBucket)
                                                 .setProjectId(ProjectID);
        FirebaseApp.initializeApp(this, OptionsBuilder.build());
        Analytics = FirebaseAnalytics.getInstance(this);
      }

      public void AndroidThunkJava_LogEvent(String EventName)
      {
        Bundle Parameters = new Bundle();
        Analytics.logEvent(EventName, Parameters);
      }

      public void AndroidThunkJava_LogEventWithParameter(String EventName, String ParameterName, String ParameterValue)
      {
        Bundle Parameters = new Bundle();
        Parameters.putString(ParameterName, ParameterValue);
        Analytics.logEvent(EventName, Parameters);
      }

      public void AndroidThunkJava_LogEventWithParameter(String EventName, String ParameterName, float ParameterValue)
      {
        Bundle Parameters = new Bundle();
        Parameters.putFloat(ParameterName, ParameterValue);
        Analytics.logEvent(EventName, Parameters);
      }

      public void AndroidThunkJava_LogEventWithParameter(String EventName, String ParameterName, int ParameterValue)
      {
        Bundle Parameters = new Bundle();
        Parameters.putInt(ParameterName, ParameterValue);
        Analytics.logEvent(EventName, Parameters);
      }

      ///
      // With Parameters
      //

      public void AndroidThunkJava_ResetAnalyticsData()
      {
        Analytics.resetAnalyticsData();
      }

      public void AndroidThunkJava_SetAnalyticsCollectionEnabled(boolean Enabled)
      {
        Analytics.setAnalyticsCollectionEnabled(Enabled);
      }

      public void AndroidThunkJava_SetSessionTimeoutDuration(int Milliseconds)
      {
        Analytics.setSessionTimeoutDuration(Milliseconds);
      }

      public void AndroidThunkJava_SetUserID(String UserID)
      {
        Analytics.setUserId(UserID);
      }

      public void AndroidThunkJava_SetUserProperty(String PropertyName, String PropertyValue)
      {
        Analytics.setUserProperty(PropertyName, PropertyValue);
      }
    </insert>
  </gameActivityClassAdditions>

</root>